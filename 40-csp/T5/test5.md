# 数据抢修 (repair)

## 题目背景
由小 C 和小 F 开发的 CrazyFry 服务突然出现了故障，这导致了诸多平台的访问受到影响，现在他们正在紧急抢修。

## 题目描述
CrazyFry 目前有 $n$ 个数据包，每个数据包初始包含一些元素，也可能为空，每个元素有一个权值。数据包编号为 $1 \sim n$，默认为激活状态。同一个数据包允许出现权值相同的元素，即数据包可以看做一个可重集。

小 C 为 CrazyFry 设定了一个稳定值 $W$。一个 CrazyFry 数据包是**稳定**的当且仅当其中**任意两个**元素的权值 $x, y$ 均满足 $x \oplus y \ge W$。其中 $\oplus$ 表示按位异或运算。显然，只有一个元素的数据包一定是稳定的。

将一个数据包划分为若干子数据包，使得每个元素**恰好**出现在其中一个子数据包，且每个子数据包都是稳定的，我们称这样的划分方式是**稳定**的。一个稳定的划分方式所分出的子数据包数量的**最小值**为该数据包的**维修代价**。CrazyFry 的**维修代价**为目前所有处于**激活状态**的数据包的维修代价的**总和**。

现在小 F 要对 CrazyFry 进行测试，他会进行 $q$ 次操作：

- `1 u x`：在编号为 $u$ 的数据包中添加一个权值为 $x$ 的元素，保证 $u$ 目前处于激活状态。
- `2 u v`：将编号为 $v$ 的数据包合并到编号为 $u$ 的数据包里，保证 $u \neq v$ 且 $u, v$ 均处于激活状态，此后 $v$ 处于离线状态，并且不会出现在之后操作中。
- `3`：查询操作，询问目前 CrazyFry 的维修代价。

## 输入格式
从标准输入读入数据。

第一行读入一个正整数 $n$ 和一个正整数 $W$。

接下来 $n$ 行，第 $i$ 行首先读入一个非负整数 $m_i$，表示编号为 $i$ 的数据包的初始元素个数，随后读入 $m_i$ 个非负整数，表示数据包中元素的权值。

下一行读入一个正整数 $q$，表示操作个数。

接下来 $q$ 行，每行先读入一个正整数 $op$：

- 若 $op=1$，表示进行 1 操作，接下来读入两个整数 $u, x$。
- 若 $op=2$，表示进行 2 操作，接下来读入两个整数 $u, v$。
- 若 $op=3$，表示进行 3 操作。

操作含义同上文描述。

## 输出格式
输出到标准输出。

对于每一个查询操作，输出一行一个整数，表示 CrazyFry 的维修代价。

## 样例1输入
```
3 16
1 21
1 16
1 29
5
3
2 2 1
3
2 3 2
3
```

## 样例1输出
```
3
3
3
```

## 样例1解释
任意两个元素的权值异或都小于 $W$，故每个元素必须单独放在一个子数据包里，答案始终为 3。

## 样例2输入
```
5 15
7 4 7 8 13 13 0 11
1 11
9 9 4 19 0 11 9 5 9 8
2 9 16
4 10 17 12 1
9
1 3 10
1 5 19
2 1 4
1 2 16
3
1 2 18
1 5 11
3
2 5 2
```

## 样例2输出
```
17
19
```

## 样例3输入
```
3 2
0
0
2 7 5
2
2 2 1
3
```

## 样例3输出
```
1
```

## 样例3解释
$7 \oplus 5 \ge 2$，故 7, 5 可以放入一个子数据包里，答案为 1。

## 子任务
本题采用捆绑测试，你只有通过一个子任务中的所有测试点才能得到该子任务的分数。

全部测试数据满足：$1 \le n, q, \sum_{i=1}^{n} m_i \le 5 \times 10^5$，所有权值值域为 $[0, 10^9]$ 且 $W > 0$。

- 子任务一（20 分）：$1 \le n, q, \sum_{i=1}^{n} m_i \le 10$，所有权值值域为 $[0, 10^3]$。
- 子任务二（15 分）：$1 \le n, q, \sum_{i=1}^{n} m_i \le 100$，所有权值值域为 $[0, 10^3]$。
- 子任务三（15 分）：$1 \le n, q, \sum_{i=1}^{n} m_i \le 10^3$，所有权值值域为 $[0, 10^6]$。
- 子任务四（20 分）：$1 \le n, q, \sum_{i=1}^{n} m_i \le 10^5$，所有权值值域为 $[0, 10^6]$。
- 子任务五（30 分）：无特殊限制。
